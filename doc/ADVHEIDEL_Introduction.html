<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ADVHEIDEL_Introduction</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ADVHEIDEL_Introduction</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ADVHEIDEL)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(goftest)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette provides an overview of the <code>ADVHEIDEL</code>
package, a tool for conducting Markov Chain Monte Carlo (MCMC)
convergence diagnostics based on the <strong>Heidelberger-Welch</strong>
method. Developed to support convergence assessment in probabilistic
models, especially Bayesian inference, the <code>ADVHEIDEL</code>
package enhances the traditional Heidelberger-Welch diagnostic with
advanced stationarity tests, efficient computational handling of large
datasets, and visualization tools for detailed analysis.</p>
<p>The <strong>Heidelberger-Welch diagnostic</strong> is a powerful
method that checks if MCMC samples have transitioned from an initial,
unstable state (the “transient phase”) to a stable, steady-state
distribution. By discarding portions of early samples in incremental
steps, this approach ensures that only well-mixed samples, reflective of
the target distribution, are analyzed. This is especially valuable for
models with complex probability distributions that can take longer to
reach stability.</p>
</div>
<div id="key-methodology-stepwise-data-discard-in-stationarity-testing" class="section level2">
<h2>Key Methodology: Stepwise Data Discard in Stationarity Testing</h2>
<p>The Heidelberger-Welch method includes a unique, iterative data
discarding approach to determine whether the chain has reached a stable
distribution:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Initial Test and Discarding Iterations</strong>:<br />
The diagnostic starts by applying a stationarity test to the full MCMC
chain (e.g., the Cramer-von Mises test). If this first test fails, the
initial 10% of samples is discarded, removing early values that may not
yet represent the true distribution. The test is then reapplied to the
trimmed chain.</p></li>
<li><p><strong>Incremental Discards (10% Steps up to
50%)</strong>:<br />
This process continues in increments of 10% (up to a maximum of 50%
discard), with each test discarding additional data only if stationarity
has not yet been achieved. At each discard level, a stationarity test
assesses whether the remaining samples indicate convergence.</p></li>
<li><p><strong>Final Convergence Validation</strong>:<br />
When the test passes at any discard level, the analysis proceeds with
only the stable, remaining samples. This progressive trimming approach
strengthens the reliability of convergence checks, making the diagnostic
more resilient to initial transient behavior and early instability in
the chain.</p></li>
</ol>
<p>By iteratively refining the chain, the Heidelberger-Welch method
effectively isolates and analyzes the steady-state samples, providing a
robust diagnostic for complex MCMC models. This stepwise method is
instrumental in ensuring the reliability of the analysis, especially for
models with intricate convergence dynamics.</p>
</div>
<div id="package-features" class="section level2">
<h2>Package Features</h2>
<p>The <code>heidelbergerWelchDiag</code> package offers the following
key features:</p>
<ul>
<li><p><strong>Multiple Stationarity Tests</strong>: Users can select
from several stationarity tests, including:</p>
<ul>
<li>Kolmogorov-Smirnov (KS) test</li>
<li>Cramer-von Mises (CVM) test</li>
<li>Shapiro-Wilk test</li>
</ul></li>
<li><p><strong>Stepwise Discard Ratios</strong>: The package calculates
metrics at different discard levels (0%, 10%, …, 50%) to ensure that
initial transient states are excluded.</p></li>
<li><p><strong>Half-Width Test for Precision</strong>: The half-width
test assesses if the sample mean’s confidence interval width is below a
threshold, ensuring precision in the parameter estimates.</p></li>
<li><p><strong>Efficient Computation</strong>: Optimized C++ code via
Rcpp for high-performance calculations, particularly beneficial for
large-scale MCMC simulations.</p></li>
<li><p><strong>Visualization Tools</strong>: Trace plots, cumulative
mean plots, and half-width plots for intuitive analysis of
convergence.</p></li>
</ul>
</div>
<div id="usage-example" class="section level2">
<h2>Usage Example</h2>
<p>This section demonstrates how to use the package to apply the
Heidelberger-Welch diagnostics to an MCMC sample.</p>
<div id="generating-sample-data" class="section level3">
<h3>Generating Sample Data</h3>
<p>Here, we generate a synthetic MCMC chain for demonstration
purposes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Sample MCMC chains</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>chain1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>chain2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>mcmc_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(chain1, chain2)</span></code></pre></div>
</div>
<div id="diagnostic-overview" class="section level3">
<h3>Diagnostic Overview</h3>
<p>To run the Heidelberger-Welch diagnostic with custom metrics, use the
<code>advheidel.diag</code> function, which provides a thorough
convergence analysis. Results can be viewed through <code>print</code>
or <code>summary</code>.</p>
</div>
<div id="running-the-diagnostic" class="section level3">
<h3>1. Running the Diagnostic</h3>
<ul>
<li><strong><code>advheidel.diag</code></strong>: This function runs an
MCMC convergence diagnostic, performing both stationarity and half-width
tests. Custom metrics are calculated across discard ratios (0%, 10%, …,
50%) for an in-depth evaluation of convergence.</li>
</ul>
</div>
<div id="viewing-results" class="section level3">
<h3>2. Viewing Results</h3>
<ul>
<li><strong><code>print</code></strong>: Offers detailed chain-by-chain
diagnostic results, including:
<ul>
<li><strong>Stationarity and Half-Width Tests</strong>: Checks if the
chain has reached a stable distribution and if the confidence interval
width meets the desired precision threshold.</li>
<li><strong>Custom Metrics</strong>: Displays additional metrics at
varying discard ratios if enabled, providing insights into convergence
trends.</li>
</ul></li>
<li><strong><code>summary</code></strong>: Summarizes the overall
diagnostic results, showing the number of chains that passed or failed
both the stationarity and half-width tests.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Apply the Heidelberger-Welch diagnostic</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">advheidel.diag</span>(mcmc_data, <span class="at">custommetrics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Heidelberger-Welch MCMC Diagnostic Results:</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Chain      Stationarity    p-value    Start Iteration TestType   Mean       Half-Width (Ratio)    Half-Width Test</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 1          Passed          0.9786     1               ks         1.0645     0.2462     0.2312     Failed         </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 2          Passed          0.8768     1               ks         2.1274     0.1880     0.0884     Passed         </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;   Custom Metrics for Chain1: </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;    Discard Ratio   Start.Iteration Stationary p-value         Mean       Variance   Half-Width      Ratio      Test      </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;    ------------------------------------------------------------------------------------------------------------------------ </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;    0.00            1               Passed     0.9786          1.0645     15.7353    0.2462          0.2312     Failed    </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;    0.10            101             Passed     0.9783          1.0315     16.0066    0.2617          0.2537     Failed    </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;    0.20            201             Passed     0.7379          1.0892     16.1262    0.2787          0.2559     Failed    </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;    0.30            301             Passed     0.4689          1.0331     16.3634    0.3002          0.2906     Failed    </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt;    0.40            401             Passed     0.5356          1.0628     16.2355    0.3231          0.3040     Failed    </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt;    0.50            501             Passed     0.6716          0.9907     16.3508    0.3553          0.3586     Failed    </span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;   Custom Metrics for Chain2: </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;    Discard Ratio   Start.Iteration Stationary p-value         Mean       Variance   Half-Width      Ratio      Test      </span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;    ------------------------------------------------------------------------------------------------------------------------ </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt;    0.00            1               Passed     0.8768          2.1274     9.1750     0.1880          0.0884     Passed    </span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt;    0.10            101             Passed     0.9194          2.1016     9.1107     0.1975          0.0940     Passed    </span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;    0.20            201             Passed     0.5307          2.1215     9.1375     0.2098          0.0989     Passed    </span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt;    0.30            301             Passed     0.5933          2.1399     9.3442     0.2268          0.1060     Failed    </span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt;    0.40            401             Passed     0.8043          2.1933     9.3553     0.2452          0.1118     Failed    </span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;    0.50            501             Passed     0.5817          2.1762     9.4919     0.2707          0.1244     Failed    </span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------------------------------------------------------------------------- </span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; Summary:</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt;   - Total Chains:                   2 </span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt;   - Chains Passed Stationarity:     2 / 2 </span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt;   - Chains Passed Half-Width Test:  1 / 2 </span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt;   - Custom Metrics Available</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; Summary of Heidelberger-Welch Diagnostic Results:</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt; Total Chains Analyzed:  2 </span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt; Stationarity Test: </span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt;   Passed:  2 </span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt;   Failed:  0 </span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#&gt; Half-Width Test: </span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt;   Passed:  1 </span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co">#&gt;   Failed:  1</span></span></code></pre></div>
</div>
<div id="explanation-of-output" class="section level3">
<h3>Explanation of Output</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Stationarity Test</strong>: Verifies if the chain has
reached a steady-state distribution, indicating that the MCMC chain has
likely converged.</p></li>
<li><p><strong>Half-Width Test</strong>: Measures the precision of the
sample mean estimate by calculating the width of the confidence
interval. If the interval is narrow relative to the mean, it suggests a
precise estimate.</p></li>
<li><p><strong>Custom Metrics</strong>: Adds additional metrics across
discard levels (0%, 10%, …, 50%) for a robust diagnostic view, helping
to assess convergence patterns at various points in the chain.</p></li>
</ol>
</div>
<div id="visualizing-convergence" class="section level3">
<h3>Visualizing Convergence</h3>
<p>You can also visualize convergence for each chain using
<code>plot</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Plot diagnostic results</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="explanation-of-output-1" class="section level3">
<h3>Explanation of Output</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Trace Plot</strong>: Shows the progression of the MCMC
chain over iterations. A stable plot without trends suggests that the
chain is well-mixed and has converged.</p></li>
<li><p><strong>Cumulative Mean Plot</strong>: Displays the cumulative
mean across iterations. A leveling off of this mean indicates
convergence. The start iteration and overall mean are marked for
reference.</p></li>
<li><p><strong>Half-Width Plot</strong>: Evaluates the precision of the
mean estimate by plotting the confidence interval’s half-width. A
smaller, stable half-width indicates sufficient precision in the
estimate.</p></li>
</ol>
</div>
</div>
<div id="implementation-details-heidelwelchmetric-custom-metric-function" class="section level2">
<h2>Implementation Details: <code>heidelWelchMetric</code> Custom Metric
Function</h2>
<p>The core functionality of this package is implemented in C++ for
optimized performance, especially with large datasets. The
<code>heidelWelchMetric</code> function performs diagnostic calculations
at various discard levels (0%, 10%, …, 50%) for the MCMC chain data:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Mean and Variance Calculation</strong>: At each discard
level, the mean and variance are computed on the trimmed data. This
helps assess stability and consistency of the mean over different
portions of the data.</p></li>
<li><p><strong>Half-Width Calculation</strong>: The function calculates
the half-width of the confidence interval for each discard level, based
on the trimmed sample’s variance and size. The half-width ratio is then
computed as the half-width divided by the mean, and it is tested against
a predefined threshold to determine if the estimate’s precision is
sufficient.</p></li>
<li><p><strong>Stationarity Test (Cramer-von Mises)</strong>: For each
discard level, the Cramer-von Mises test is applied to check for
stationarity, assessing whether the samples are drawn from a stable
distribution. This test returns a p-value, and a result of “passed” or
“failed” based on whether the p-value meets the chosen significance
level.</p></li>
</ol>
<p>The function returns a DataFrame with the results for each discard
level, including the mean, variance, half-width, half-width ratio,
p-value from the stationarity test, and pass/fail indicators for both
the half-width and stationarity tests.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">// Example of C++ code used within the package</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>DataFrame heidelWelchMetric<span class="op">(</span>NumericVector x<span class="op">,</span> <span class="dt">double</span> alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">double</span> eps <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="co">// Function code ...</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="unit-testing-and-validation" class="section level2">
<h2>Unit Testing and Validation</h2>
<p>We implemented comprehensive unit tests to ensure that each function
operates as expected. The tests validate:</p>
<ul>
<li>Accurate calculation of mean, variance, and half-width</li>
<li>Proper execution of stationarity and half-width tests</li>
<li>Correct results for different discard levels and alpha values</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Example test case</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;heidelWelchMetric calculates mean, variance, and half-width correctly&quot;</span>, {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">heidelWelchMetric</span>(x)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">expect_equal</span>(result<span class="sc">$</span>Mean[<span class="dv">1</span>], <span class="fu">mean</span>(x), <span class="at">tolerance =</span> <span class="fl">1e-8</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li>Heidelberger, P., &amp; Welch, P. D. (1983). <em>Simulation run
length control in the presence of an initial transient</em>. Operations
Research, 31(6), 1109-1144.</li>
<li>R: The coda Package. (2024). <em>’heidel.diag‘ function
documentation</em>. Retrieved from <a href="https://search.r-project.org/CRAN/refmans/coda/html/heidel.diag.html">https://search.r-project.org/CRAN/refmans/coda/html/heidel.diag.html</a></li>
<li>Cowles, M. K., &amp; Carlin, B. P. (1996). <em>Markov chain Monte
Carlo convergence diagnostics: a comparative review</em>. Journal of the
American Statistical Association, 91(434), 883-904.</li>
<li>Sahlin, K. (2011). <em>Estimating convergence of Markov chain Monte
Carlo simulations</em>. Mathematical Statistics, Stockholm University,
Sweden.</li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
